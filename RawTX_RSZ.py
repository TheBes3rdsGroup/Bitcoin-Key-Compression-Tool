import bitcoin
import hashlib
import txnUtils
import keyUtils

tx = "01000000000109f7887354455417d878074c97075253325afe406ab3329af88e11ef004f8eef1901000000232200208e71341b6397420a975b962a5858c918bc364415063247612fa651765cb0af42ffffffffa8b4bd93742ce50617df9ca33fdfaa5cab1e7c92ef1699457b9fc86e5e3e71520400000000ffffffff3064d8baa1846c5b48137396908df61390ef89e55d56cd7ce7c3b71f99afbc6e0100000023220020a38b402d8d5ad539bd6d041aeef2d59852c68cac98c9e22c022de8610d3bf784ffffffff606d20a097431b2c9a007e96cf101fa9f2d0954e6944895424ed0e4fd6689e7c000000002322002053c6e292ff0d06d801ab515e1327cc6b0977f91a4973522a1c3d21139bd0ac53ffffffff0b7e6f51931864857acf6e0cc9a07a8ec18f8c5492f5ec83a21f02d2213ffe950100000023220020332b2b890e4b34fb3f9ce8e6a94f798d957b5786fc9c70461f2ff8feefcfc6bbffffffffeeba05a6e17a73b0a05f00b62ecc532ec4b44c7de9b29bb65dcc927efec342db0100000023220020c6410845b32be4db846017bcd0022322191b562b63ea9f6e989ec4b1963d15e2ffffffff2e9cff4a0fa30b6316e97b6696b402c1d74b2ccfdf9b901b590f0ead22cf9edf0700000000ffffffff61a7058144b0a7d72b6af7120fe1e7e16cb42f7e675172986685418020e013fa000000002322002064f89d4022919ca045a081061d3e924ae687ea01809576d17cc90813c5120941ffffffff9ec99ff9aa6a7a61786729e590a422140f5848a50116e071b07ad684c19593ff0000000023220020ca3acee26259738dfa84a9b18077f6b324d8d9840043d12b9e4eeeea9774f570ffffffff07fe1d0000000000002200204364063fac8829a931a752ecd9049e43425e2cebf83681876c556002bf389b002b9f0000000000001976a91412ebb005bcae95ef842a22ea37c26dd7df526ff388acd40601000000000017a914dabb6ec55def6b2a225001161df492db03bf470b879fa901000000000017a91453fdc246b7903620f80bc90693d68a87733daadd874ebc02000000000017a9141a8778d8c8f71ba91285e2daf3d90a4c69bd4261870916b10100000000160014ab839bd5df2c55b40328d60f28ef18502110b188f65c5c0500000000220020b6f7875d856a4ac43bb070f7591768b18d551095b8a37da5c515483ebffe14bc0400483045022100f9ce27b90e8669110bf165bd63f0cca7dcb3197a68d0a38087af094d5cf19ad6022002264425878f23baa49e87dd75ef3c23dcc328a1ef2d15040428da2fff8a82ce0147304402205e235a1cb54abeb1de48a955883755e6355bd422cddb8d7c41983bf2665635820220701d4824fb1768a7e78ed7be0435f3b21d4d24b2eda735fe1d3e5a1e9246f1df01695221028731c21c841809d91598b1cb27f38d5d7c226f8abc52b34d7a3bba02eefb2fd32103540cd6bf4670f9db5a1209e391d7b6503d4edd9ca79eae214b481edd1ecd975121028f8a8a005ff4813447c9e232250e6c0e1d22b4b700040acb9230a6fb92fd608a53ae0400473044022047cf6a837fb946d23abd02d0f7a2a6d80ba2015f11f77a91d5568ed661125ef0022067413fe0be6ea1cc83a759ca0d7f95b44d78f57b6b5b4bb8cdd29b9ad56ce37b01473044022036658114ab17a6f1440e4bc442679f14b6086a6de093fc2f4db21b0eb298036502202d45d52a216e3d9fd2e6f4287be990ffb9ad9721786839aae911b95bc8b002d50169522103f77f7a5cae211bd0554274601d178b05128b49be015e81d6f419bee612870a88210276a1b58027e7c509fa5116cff6a0849cc13fcf5a938381e437d2a0fe647ad71a210313380ef80438ea97aa0a2cfa66c777bf73067f569002cb4c928a2551e3ece9c753ae040047304402206e193d7c4567b3e485078e3cc9aeb41820b4d7b08cab89053368c119df4c8a7402202b42591d3166468d12be7dfaf9a8c0bcbcf9b219ceb2919616161c5353b017f601473044022068d24c18c81b5070dd4680391e28b540ae04183ee2af8349449e216194a8401e02202fc71caede3c2938afeb1611ea05187305778a8d8b7f853428b27f97e3b9d14101695221020e8a060f10fd0846dfd562c643977d7491e69f5f365639c984ebd1e0aac3056921026a9c5504507b9f786d2175ee0b0919468d8ee88222b755334c2d6b61b9cfeafe21021e309ea1673214c55d9f2bb6817daa506c9717d99885864e7df04f95db58ab6353ae040048304502210097b1701b8cf5f62997d7e3c0003d4ae7b038054e02c68457e925488de1f8e7d402203d5b59b5b0af7ecaa1f63be778bbf3abc71abe85f8d61a72c2b4e4c9593646ed0147304402203c4381d0dfc9064909fb716f25d9d07934abbfcb89c303d67afc3fbb7fa9a8c602205ac09b9ac5bbc6f26234d5658030367b494dec0cc62e301156d5b39668bb0e3b0169522103d589f9537150d85cd1b961f118248598ac6f369312a8b07a2bdce8867fde61d421022ad787fad491cba1caa8df9fab0ddc830e5777e6782721632e2e6f4231105f0e21021a4b1819f3bcdc920d2315b651c14a01f16c8ce8a234b582bc8ab5c6797f7d2a53ae0400473044022054fd2505ee5c6656f1756124a2bd1d342ee69b965879a52216dbf62b4d14ca7402204bc41349e5066c30c7b4f2c0ac63ca8821f299318b0081ff3924fc18df6c5de701473044022033532f91f796846ce432dabaf06ca273ca49d4d1fcfca8093422691258ddeec402202560871728e50ac6cc0dfa8e15d88ade06b80577daaf6f7379c9ba721d9cda950169522102efeba7e2b49f3f738bb9822ce2685b87cfd2b4f337dca9a399ff47484a505eed2103b9c5767dc3d614d7a8ed22cf99189b84b9446763cb5a90e37df3876d64df684b2103bd5cd05045d8196702ab0c1dff41d7638cad64f8a190f2ee10452225c7ca918e53ae040047304402200953a1a46c843b2acd3369c7bf11c72da2bff3438987710434fa7dfd90ae020a0220482e598514ffdb9c629887b6ffe996a5dfb27637c25e669e70bb385d2800b2890147304402207a5c8264a6ee68a5c88a3559f6a34fbd595cff205ed463907c2eb227229601b10220622bfc408d03a286a804f179a1a6e9b61cce2d74934c4dcfbcedda9da7a4d7b801695221025c494a4698c694638ebd83adf6f8ab7cfc7a62d48b600e025d515970ee23a51921032d9f382c212991de99785917a879e97eacae3773cdf3163c82aebac99c86a8e5210294f27a6c3b60c5516dc213b99335ecd9a9fc472aadd5a6d5b70294f4bbf5dc0253ae040048304502210094a171c877b5c457c09e4e4f155e6c71986fb25b60d5ae561d4d9c6505f47fcb0220319081203e3cc91033c56cc6a89617ffac244d8c4be732cbdc0561d0b5579a5001473044022058f6a7bdfd7086f5e13f6214838b5bc0f48f8fe263ab65347f1e04c4190b4c3c02204faccf8754016caaaa5286315e0e756fa08199a9d73cd77c4788ce711f7337b8016952210230c8bb3fcfb17ece0ad28c8e02383e09bccdefd66bc36ce2d4a774d584518dfc21022245b7b8986b2386b7e7b5f07b93ed1a0ea4f8569d865da8d1379f298e5708ac2103125af267c195f7147936c6602547ae6cf8be7ab956892e2c58336e58ec430bfb53ae04004830450221009926c16235a6104632b5807945b7e48a7b1d7072a15fed3c4f3110c9b8067a56022020b8ccb55883cfb3f751f796648efd61a10fd7f756d5dd3746ffef0f7c4986a1014730440220675463bf14537e0c3182c568ea489b718e7b8e910505ad1fbc290297bdcc4251022049ee7daf319f95f07ed99cd15d88b4a39fcd756d1923e37080b9753a3628ee360169522102264686cde6ca9c744bc2dc0fce4608f1c6d33cd66d45e1495dcbeffac257475b21025a861656810be807902e258806bcd83084bdd5588a8320ddf50c7276e35df2162102a2ed1f8434a02fc3f3aeb5d1d0e8b949cd25d2d2effa662826225ee8342029d553ae0400483045022100d31531f88f266da27382236e9fc3142b51cc6828d7a07ae8e27eb016da4a405e02206ba6363022de97f38b15a8526e92403a1cf76f4f3ca8ed5bc375f7baf0abe4000147304402202b38d894cc20fc927e273a829ed732b365e06aa9aa09b32d1ee786870f795de90220366a4140924bbeed072523ebb1704b49c69a7097ea60c04c83b885d5c5464bcf0169522103166fbe49a04f981f2957b76cc31f737ceebd02fd6cce583bb98d0b0e5411d08521032430adfc8d7b3f5cb877401e9b97e2ecef8b42842d346c21711df041ead86bea21021bbfeb220a634a3c4ecba44d6100e45136673e8cbe599f7e8b4c3e16ac49c05453ae9e720b00"

m = txnUtils.parseTxn(tx)
e = txnUtils.getSignableTxn(m)
z = hashlib.sha256(hashlib.sha256(e.decode('hex')).digest()).digest()
z1 = z[::-1].encode('hex_codec')
z = z.encode('hex_codec')
s = keyUtils.derSigToHexSig(m[1][:-2])
pub =  m[2]
sigR = s[:64]
sigS = s[-64:]
sigZ = z
print(('Signed TX is :', tx))
print(('Signature (r, s pair) is :', s))
print(('Public Key is :', pub))
print ("")
print ("#################################################################################################")
print ("")
print(('Unsigned TX is :', e))
print(('hash of message (sigZ) is USE This ONE :', z))
print(('reversed z :', z1))
print ("")
print ("#################################################################################################")
print ("##################################VALUES NEEDED ARE BELOW #######################################")
print ("#################################################################################################")
print ("")
print(('THE R VALUE is  :', sigR))
print(('THE S VALUE is  :', sigS))
print(('THE Z VALUE is  :', sigZ))
print(('THE PUBKEY is :', pub))




